# 重复图片检测功能文档

## 功能概述
该功能扫描图片库并检测出重复或高度相似的图片，支持多种相似度算法，帮助用户清理重复文件。

## 实现方式
- 集成图像相似度算法
- 使用现有图片管理功能
- 通过哈希算法和特征匹配

## 命令接口
```
/ai-gitee find-duplicates <图片文件夹> [相似度阈值]
```

## 相似度阈值选项
- exact (完全相同)
- very-high (极高相似)
- high (高相似)
- medium (中等相似)
- low (低相似)

## 检测算法
- 哈希值比较 (Hash Comparison)
- 感知哈希 (Perceptual Hash)
- 差值哈希 (Difference Hash)
- 颜色直方图 (Color Histogram)
- SIFT特征匹配
- 深度学习特征匹配

## 输入参数
- 图片文件夹路径
- 相似度阈值（可选，默认high）
- 检测算法（可选，默认综合算法）
- 包含子目录（是/否）
- 忽略元数据（是/否）

## 输出结果
- 重复图片组列表
- 相似度百分比
- 文件路径和大小信息
- 推荐保留的图片

## 检测类型
- 完全相同文件
- 相同内容不同格式
- 裁剪版本图片
- 旋转/翻转版本
- 不同质量版本
- 轻微编辑版本

## 重复组分析
- 画质对比
- 文件大小对比
- 拍摄时间对比
- 完整度对比

## 输出格式
```
重复图片组:
组1:
- photo1.jpg (5MB, 2023-01-01) - 推荐保留
- photo1_copy.jpg (3MB, 2023-01-02) - 建议删除
- image_001.png (4.5MB, 2023-01-01) - 建议删除

相似度: 98.5%
```

## 推荐保留策略
- 画质最高的图片
- 文件完整的图片
- 较新的图片
- 用户自定义规则

## 智能分析
- 自动识别最佳画质
- 分析EXIF完整度
- 时间戳对比
- 文件完整性检查

## 安全措施
- 检测前预览
- 批量操作确认
- 支持撤销删除
- 操作日志记录

## 输出选项
- 重复组列表
- 详细分析报告
- 删除建议
- 统计摘要

## 处理选项
- 预览模式（只检测不操作）
- 移动模式（移至专门文件夹）
- 软链接模式（创建链接）
- 删除模式（永久删除）

## 排除规则
- 保留特定文件夹
- 排除特定格式
- 忽略小尺寸图片
- 用户自定义规则

## 批量处理
- 支持大量图片
- 分批检测
- 进度显示
- 断点续传

## 优化算法
- 增量更新检测
- 快速初步筛选
- 多线程并行处理
- 内存优化

## 详细分析
- 文件属性对比
- 元数据比较
- 画质指标分析
- 压缩方式检测

## 验证检查
- 删除前二次确认
- 重要文件保护
- 备份策略验证
- 回收站使用

## 预览功能
- 重复组预览
- 相似度对比
- 文件信息显示
- 选择保留建议

## 统计信息
- 总检测数量
- 重复组数量
- 节省空间估算
- 处理时间统计

## 错误处理
- 无法读取文件跳过
- 权限不足文件跳过
- 文件夹不存在提示
- 处理中断处理

## 撤销功能
- 删除操作记录
- 批量恢复功能
- 部分撤销
- 历史记录查询

## 适用场景
- 图片库清理
- 存储空间释放
- 重复文件整理
- 数字资产管理