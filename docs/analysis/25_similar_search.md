# 相似图片搜索功能文档

## 功能概述
该功能在本地图片库中搜索与指定图片相似的图片，基于内容相似度匹配，帮助用户查找和整理图片。

## 实现方式
- 集成图像相似度算法
- 使用现有图片管理功能
- 通过本地特征匹配

## 命令接口
```
/ai-gitee find-similar <参考图片> [搜索范围]
```

## 搜索范围
- all (全部图片库)
- recent (最近一周)
- folder (指定文件夹)
- custom (自定义时间段)

## 输入参数
- 参考图片文件
- 搜索范围（可选，默认all）
- 相似度阈值（50%-95%，默认80%）
- 结果数量（1-20个，默认10个）

## 搜索算法
- 特征提取算法
- 余弦相似度计算
- 图像哈希匹配
- 深度学习特征向量

## 输出结果
- 相似的图片列表
- 相似度百分比
- 图片基本信息（路径、大小、日期）

## 匹配类型
- 完全相同（经过压缩、格式转换的同一图片）
- 高度相似（裁剪、旋转、亮度调整等轻微修改）
- 主要内容相似（同一场景的不同角度）
- 主题相似（相似内容的完全不同的图片）

## 相似度评分
- 95-100%：几乎相同
- 90-94%：高度相似
- 80-89%：相似
- 70-79%：相关内容
- 60-69%：主题相似

## 输出格式
```
找到相似图片:
1. image1.jpg - 相似度: 92% - 路径: /path/to/image1.jpg
2. image2.png - 相似度: 87% - 路径: /path/to/image2.png
3. image3.jpeg - 相似度: 83% - 路径: /path/to/image3.jpeg

共找到3张相似图片
```

## 搜索优化
- 多级索引加速
- 特征向量缓存
- 并行匹配计算
- 智能预过滤

## 搜索选项
- 包含子目录（是/否）
- 忽略EXIF方向（是/否）
- 仅搜索特定格式
- 日期范围限制

## 输出选项
- 相似图片列表
- 详细信息表格
- 图片缩略图对比
- JSON格式数据

## 智能整理
- 重复图片标记
- 变体图片归类
- 最佳质量推荐
- 相似图片组管理

## 处理限制
- 单次搜索不超过10000张图片
- 搜索时间限制为60秒
- 结果缓存30分钟

## 性能优化
- 预计算特征向量
- 渐进式搜索
- 结果分页显示
- 搜索进度指示

## 错误处理
- 图片库过大时提示分批搜索
- 搜索超时时显示已找到的结果
- 无法匹配时提供调整建议

## 适用场景
- 重复图片清理
- 图片分类整理
- 相似内容查找
- 内容侵权检测